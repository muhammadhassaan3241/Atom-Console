function cov_19uqk30huz(){var path="C:\\Users\\a\\Atom-Console-Backend\\src\\helpers\\verification.js";var hash="f6134744e3ec04f4114cdbda59848decf959deca";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\Users\\a\\Atom-Console-Backend\\src\\helpers\\verification.js",statementMap:{"0":{start:{line:1,column:23},end:{line:1,column:58}},"1":{start:{line:2,column:26},end:{line:2,column:64}},"2":{start:{line:3,column:38},end:{line:3,column:68}},"3":{start:{line:4,column:12},end:{line:4,column:35}},"4":{start:{line:5,column:35},end:{line:5,column:60}},"5":{start:{line:7,column:24},end:{line:48,column:1}},"6":{start:{line:8,column:2},end:{line:47,column:3}},"7":{start:{line:9,column:22},end:{line:9,column:69}},"8":{start:{line:10,column:4},end:{line:38,column:5}},"9":{start:{line:11,column:27},end:{line:11,column:76}},"10":{start:{line:12,column:19},end:{line:27,column:8}},"11":{start:{line:28,column:6},end:{line:28,column:26}},"12":{start:{line:29,column:6},end:{line:29,column:13}},"13":{start:{line:31,column:6},end:{line:37,column:8}},"14":{start:{line:40,column:4},end:{line:46,column:6}},"15":{start:{line:50,column:0},end:{line:52,column:2}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:7,column:24},end:{line:7,column:25}},loc:{start:{line:7,column:59},end:{line:48,column:1}},line:7}},branchMap:{"0":{loc:{start:{line:10,column:4},end:{line:38,column:5}},type:"if",locations:[{start:{line:10,column:4},end:{line:38,column:5}},{start:{line:10,column:4},end:{line:38,column:5}}],line:10}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0},f:{"0":0},b:{"0":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"f6134744e3ec04f4114cdbda59848decf959deca"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_19uqk30huz=function(){return actualCoverage;};}return actualCoverage;}cov_19uqk30huz();const{statusCode}=(cov_19uqk30huz().s[0]++,require("../constants/header-code"));const{headerMessage}=(cov_19uqk30huz().s[1]++,require("../constants/header-message"));const{restResponse,apiResponse}=(cov_19uqk30huz().s[2]++,require("../controllers/base"));const jwt=(cov_19uqk30huz().s[3]++,require("jsonwebtoken"));const{Permission,Role,User}=(cov_19uqk30huz().s[4]++,require("../models/user"));cov_19uqk30huz().s[5]++;const jwtVerification=async(request,response,next)=>{cov_19uqk30huz().f[0]++;cov_19uqk30huz().s[6]++;try{const authToken=(cov_19uqk30huz().s[7]++,request.headers["authorization"]?.split(" ")[1]);cov_19uqk30huz().s[8]++;if(authToken!==null){cov_19uqk30huz().b[0][0]++;const decodedToken=(cov_19uqk30huz().s[9]++,jwt.verify(authToken,process.env.JWT_SECRET_KEY));const user=(cov_19uqk30huz().s[10]++,await User.findOne({where:{email:decodedToken?.email},attributes:{exclude:["password","parentkey"]},include:[{model:Role,attributes:["name"],include:[{model:Permission,attributes:["name"]}]}]}));cov_19uqk30huz().s[11]++;request.user=user;cov_19uqk30huz().s[12]++;next();}else{cov_19uqk30huz().b[0][1]++;cov_19uqk30huz().s[13]++;return apiResponse(response,statusCode.forbidden,"0",headerMessage.forbidden,null);}}catch(error){cov_19uqk30huz().s[14]++;return apiResponse(response,statusCode.someThingWentWrong,"0","Access Token Required",null);}};cov_19uqk30huz().s[15]++;module.exports={jwtVerification:jwtVerification};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfMTl1cWszMGh1eiIsImFjdHVhbENvdmVyYWdlIiwic3RhdHVzQ29kZSIsInMiLCJyZXF1aXJlIiwiaGVhZGVyTWVzc2FnZSIsInJlc3RSZXNwb25zZSIsImFwaVJlc3BvbnNlIiwiand0IiwiUGVybWlzc2lvbiIsIlJvbGUiLCJVc2VyIiwiand0VmVyaWZpY2F0aW9uIiwicmVxdWVzdCIsInJlc3BvbnNlIiwibmV4dCIsImYiLCJhdXRoVG9rZW4iLCJoZWFkZXJzIiwic3BsaXQiLCJiIiwiZGVjb2RlZFRva2VuIiwidmVyaWZ5IiwicHJvY2VzcyIsImVudiIsIkpXVF9TRUNSRVRfS0VZIiwidXNlciIsImZpbmRPbmUiLCJ3aGVyZSIsImVtYWlsIiwiYXR0cmlidXRlcyIsImV4Y2x1ZGUiLCJpbmNsdWRlIiwibW9kZWwiLCJmb3JiaWRkZW4iLCJlcnJvciIsInNvbWVUaGluZ1dlbnRXcm9uZyIsIm1vZHVsZSIsImV4cG9ydHMiXSwic291cmNlcyI6WyJ2ZXJpZmljYXRpb24uanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgeyBzdGF0dXNDb2RlIH0gPSByZXF1aXJlKFwiLi4vY29uc3RhbnRzL2hlYWRlci1jb2RlXCIpO1xyXG5jb25zdCB7IGhlYWRlck1lc3NhZ2UgfSA9IHJlcXVpcmUoXCIuLi9jb25zdGFudHMvaGVhZGVyLW1lc3NhZ2VcIik7XHJcbmNvbnN0IHsgcmVzdFJlc3BvbnNlLCBhcGlSZXNwb25zZSB9ID0gcmVxdWlyZShcIi4uL2NvbnRyb2xsZXJzL2Jhc2VcIik7XHJcbmNvbnN0IGp3dCA9IHJlcXVpcmUoXCJqc29ud2VidG9rZW5cIik7XHJcbmNvbnN0IHsgUGVybWlzc2lvbiwgUm9sZSwgVXNlciB9ID0gcmVxdWlyZShcIi4uL21vZGVscy91c2VyXCIpO1xyXG5cclxuY29uc3Qgand0VmVyaWZpY2F0aW9uID0gYXN5bmMgKHJlcXVlc3QsIHJlc3BvbnNlLCBuZXh0KSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IGF1dGhUb2tlbiA9IHJlcXVlc3QuaGVhZGVyc1tcImF1dGhvcml6YXRpb25cIl0/LnNwbGl0KFwiIFwiKVsxXTtcclxuICAgIGlmIChhdXRoVG9rZW4gIT09IG51bGwpIHtcclxuICAgICAgY29uc3QgZGVjb2RlZFRva2VuID0gand0LnZlcmlmeShhdXRoVG9rZW4sIHByb2Nlc3MuZW52LkpXVF9TRUNSRVRfS0VZKTtcclxuICAgICAgY29uc3QgdXNlciA9IGF3YWl0IFVzZXIuZmluZE9uZSh7XHJcbiAgICAgICAgd2hlcmU6IHsgZW1haWw6IGRlY29kZWRUb2tlbj8uZW1haWwgfSxcclxuICAgICAgICBhdHRyaWJ1dGVzOiB7IGV4Y2x1ZGU6IFtcInBhc3N3b3JkXCIsIFwicGFyZW50a2V5XCJdIH0sXHJcbiAgICAgICAgaW5jbHVkZTogW1xyXG4gICAgICAgICAge1xyXG4gICAgICAgICAgICBtb2RlbDogUm9sZSxcclxuICAgICAgICAgICAgYXR0cmlidXRlczogW1wibmFtZVwiXSxcclxuICAgICAgICAgICAgaW5jbHVkZTogW1xyXG4gICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIG1vZGVsOiBQZXJtaXNzaW9uLFxyXG4gICAgICAgICAgICAgICAgYXR0cmlidXRlczogW1wibmFtZVwiXSxcclxuICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBdLFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICBdLFxyXG4gICAgICB9KTtcclxuICAgICAgcmVxdWVzdC51c2VyID0gdXNlcjtcclxuICAgICAgbmV4dCgpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmV0dXJuIGFwaVJlc3BvbnNlKFxyXG4gICAgICAgIHJlc3BvbnNlLFxyXG4gICAgICAgIHN0YXR1c0NvZGUuZm9yYmlkZGVuLFxyXG4gICAgICAgIFwiMFwiLFxyXG4gICAgICAgIGhlYWRlck1lc3NhZ2UuZm9yYmlkZGVuLFxyXG4gICAgICAgIG51bGxcclxuICAgICAgKTtcclxuICAgIH1cclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgcmV0dXJuIGFwaVJlc3BvbnNlKFxyXG4gICAgICByZXNwb25zZSxcclxuICAgICAgc3RhdHVzQ29kZS5zb21lVGhpbmdXZW50V3JvbmcsXHJcbiAgICAgIFwiMFwiLFxyXG4gICAgICBcIkFjY2VzcyBUb2tlbiBSZXF1aXJlZFwiLFxyXG4gICAgICBudWxsXHJcbiAgICApO1xyXG4gIH1cclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0ge1xyXG4gIGp3dFZlcmlmaWNhdGlvbjogand0VmVyaWZpY2F0aW9uLFxyXG59O1xyXG4iXSwibWFwcGluZ3MiOiJ5NURBZVk7QUFBQUEsY0FBQSxTQUFBQSxDQUFBLFNBQUFDLGNBQUEsV0FBQUEsY0FBQSxFQUFBRCxjQUFBLEdBZlosS0FBTSxDQUFFRSxVQUFXLENBQUMsRUFBQUYsY0FBQSxHQUFBRyxDQUFBLE1BQUdDLE9BQU8sQ0FBQywwQkFBMEIsQ0FBQyxFQUMxRCxLQUFNLENBQUVDLGFBQWMsQ0FBQyxFQUFBTCxjQUFBLEdBQUFHLENBQUEsTUFBR0MsT0FBTyxDQUFDLDZCQUE2QixDQUFDLEVBQ2hFLEtBQU0sQ0FBRUUsWUFBWSxDQUFFQyxXQUFZLENBQUMsRUFBQVAsY0FBQSxHQUFBRyxDQUFBLE1BQUdDLE9BQU8sQ0FBQyxxQkFBcUIsQ0FBQyxFQUNwRSxLQUFNLENBQUFJLEdBQUcsRUFBQVIsY0FBQSxHQUFBRyxDQUFBLE1BQUdDLE9BQU8sQ0FBQyxjQUFjLENBQUMsRUFDbkMsS0FBTSxDQUFFSyxVQUFVLENBQUVDLElBQUksQ0FBRUMsSUFBSyxDQUFDLEVBQUFYLGNBQUEsR0FBQUcsQ0FBQSxNQUFHQyxPQUFPLENBQUMsZ0JBQWdCLENBQUMsRUFBQ0osY0FBQSxHQUFBRyxDQUFBLE1BRTdELEtBQU0sQ0FBQVMsZUFBZSxDQUFHLEtBQUFBLENBQU9DLE9BQU8sQ0FBRUMsUUFBUSxDQUFFQyxJQUFJLEdBQUssQ0FBQWYsY0FBQSxHQUFBZ0IsQ0FBQSxNQUFBaEIsY0FBQSxHQUFBRyxDQUFBLE1BQ3pELEdBQUksQ0FDRixLQUFNLENBQUFjLFNBQVMsRUFBQWpCLGNBQUEsR0FBQUcsQ0FBQSxNQUFHVSxPQUFPLENBQUNLLE9BQU8sQ0FBQyxlQUFlLENBQUMsRUFBRUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFDbkIsY0FBQSxHQUFBRyxDQUFBLE1BQ2xFLEdBQUljLFNBQVMsR0FBSyxJQUFJLENBQUUsQ0FBQWpCLGNBQUEsR0FBQW9CLENBQUEsU0FDdEIsS0FBTSxDQUFBQyxZQUFZLEVBQUFyQixjQUFBLEdBQUFHLENBQUEsTUFBR0ssR0FBRyxDQUFDYyxNQUFNLENBQUNMLFNBQVMsQ0FBRU0sT0FBTyxDQUFDQyxHQUFHLENBQUNDLGNBQWMsQ0FBQyxFQUN0RSxLQUFNLENBQUFDLElBQUksRUFBQTFCLGNBQUEsR0FBQUcsQ0FBQSxPQUFHLEtBQU0sQ0FBQVEsSUFBSSxDQUFDZ0IsT0FBTyxDQUFDLENBQzlCQyxLQUFLLENBQUUsQ0FBRUMsS0FBSyxDQUFFUixZQUFZLEVBQUVRLEtBQU0sQ0FBQyxDQUNyQ0MsVUFBVSxDQUFFLENBQUVDLE9BQU8sQ0FBRSxDQUFDLFVBQVUsQ0FBRSxXQUFXLENBQUUsQ0FBQyxDQUNsREMsT0FBTyxDQUFFLENBQ1AsQ0FDRUMsS0FBSyxDQUFFdkIsSUFBSSxDQUNYb0IsVUFBVSxDQUFFLENBQUMsTUFBTSxDQUFDLENBQ3BCRSxPQUFPLENBQUUsQ0FDUCxDQUNFQyxLQUFLLENBQUV4QixVQUFVLENBQ2pCcUIsVUFBVSxDQUFFLENBQUMsTUFBTSxDQUNyQixDQUFDLENBRUwsQ0FBQyxDQUVMLENBQUMsQ0FBQyxFQUFDOUIsY0FBQSxHQUFBRyxDQUFBLE9BQ0hVLE9BQU8sQ0FBQ2EsSUFBSSxDQUFHQSxJQUFJLENBQUMxQixjQUFBLEdBQUFHLENBQUEsT0FDcEJZLElBQUksRUFBRSxDQUNSLENBQUMsSUFBTSxDQUFBZixjQUFBLEdBQUFvQixDQUFBLFNBQUFwQixjQUFBLEdBQUFHLENBQUEsT0FDTCxNQUFPLENBQUFJLFdBQVcsQ0FDaEJPLFFBQVEsQ0FDUlosVUFBVSxDQUFDZ0MsU0FBUyxDQUNwQixHQUFHLENBQ0g3QixhQUFhLENBQUM2QixTQUFTLENBQ3ZCLElBQUksQ0FDTCxDQUNILENBQ0YsQ0FBRSxNQUFPQyxLQUFLLENBQUUsQ0FBQW5DLGNBQUEsR0FBQUcsQ0FBQSxPQUNkLE1BQU8sQ0FBQUksV0FBVyxDQUNoQk8sUUFBUSxDQUNSWixVQUFVLENBQUNrQyxrQkFBa0IsQ0FDN0IsR0FBRyxDQUNILHVCQUF1QixDQUN2QixJQUFJLENBQ0wsQ0FDSCxDQUNGLENBQUMsQ0FBQ3BDLGNBQUEsR0FBQUcsQ0FBQSxPQUVGa0MsTUFBTSxDQUFDQyxPQUFPLENBQUcsQ0FDZjFCLGVBQWUsQ0FBRUEsZUFDbkIsQ0FBQyJ9